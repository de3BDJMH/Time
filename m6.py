import m1
import m2
lyear_month_day=['00100101111011000', '00100101011100000', '01010010101110000', '00101010011010101', '01101001001100000', '01101100101010000', '10110010101010100', '00101011010100000', '01001101011010000', '00101010111010010',#1900
                 '00100101011100000', '01010010110110110', '01010010011010000', '01101001001010000', '11101001001010101', '01011010101000000', '01101011010100000', '01010110110100010', '01001010110110000', '10100100101110111',#1910
                 '00100100101110000', '01010010010110000', '01011010010110101', '00110101001010000', '00110110101000000', '11010101101010100', '00010101101100000', '01001010101110000', '00101001011110010', '00100100101110000',#1920
                 '00110010101100110', '01101010010100000', '01110101001010000', '10110101010010101', '00101101011010000', '00010101101100000', '11000011011100011', '01001001011100000', '11100100011010111', '01100100101010000',#1930
                 '01101010010100000', '11101100010100110', '01011010101010000', '00101011010100000', '11010010110110100', '00010010111010000', '01001001011010000', '01101001010110010', '01010100101010000', '01011010101010111',#1940
                 '00110110010100000', '01011010101010000', '10101001101010101', '00100110110100000', '01010010110110000', '10100010101110011', '00101001010110000', '01010100110101000', '01110100101010000', '00110101010100000',#1950
                 '01010111010100110', '01010101101010000', '00100101101100000', '01010101011100100', '01010010101110000', '00101001001100000', '01111001001100011', '01101100101010000', '00101101101010111', '00101011010100000',#1960
                 '01001011011010000', '00100110111010101', '00100101011010000', '01010010011010000', '01101010011010100', '01101001001010000', '01101010101011000', '01011010101000000', '01011011010100000', '11001010110100110',#1970
                 '01001010110110000', '00100100110110000', '01010100101110100', '01010010010110000', '01011001001111010', '00110101001010000', '00110110101000000', '01010111101000110', '01010101101100000', '01001010101110000',#1980
                 '00100101011110101', '00100100101110000', '00110010010110000', '00111010010100011', '01110101001010000', '00110101101011000', '00101101011000000', '01010101101100000', '01001011011010101', '01001001011100000',#1990
                 '01100100101100000', '01101100101010100', '01101010010100000', '01101101001010000', '00111010101010010', '00101011010100000', '01010101110110111', '00010010111010000', '01001001011010000', '01100101010110101',#2000
                 '01010100101010000', '01011010010100000', '01011101010100100', '01010110101010000', '00101010111011001', '00100101110100000', '01010010110110000', '10101000101110110', '00101001010110000', '01010100100110000',#2010
                 '00111100101010100', '00110101010100000', '01010110101010000', '00101101101010010', '00100101101100000', '01010011011100110', '01010010011100000', '01101001001100000', '01110101001100101', '01101010100110000',#2020
                 '00101101010100000', '00111011010100011', '01001011011010000', '00100101011111011', '00100101011010000', '01010010011010000', '11101000010110110', '01101001001010000', '01101010100100000', '01101110101000101',#2030
                 '01011010110100000', '00101011011010000', '00101010110110010', '00100100110110000', '01010010101110111', '01010010010110000', '01010101001010000', '11011001001010101', '00110110100100000', '01010110110100000',#2040
                 '10100101101100011', '01001001101110000', '00100100111111000', '00100100101110000', '00110010010110000', '10110100010100110', '01110101001010000', '00110101010100000', '11010011011000100', '01010101011100000',#2050
                 '01001001011100000', '01101001011100011', '01100100101100000', '01101010101010111', '01101010010100000', '01101101001010000', '00101110101010101', '00101011010100000', '01010011011010000', '00101010111010100',#2060
                 '00101001011010000', '01010100110111000', '01010100101010000', '01011010010100000', '01011011010100110', '01010110101010000', '00101010110100000', '01010101110100100', '01010010110110000', '00101001010110000',#2070
                 '01011001001110011', '00110100100110000', '00111001100110111', '00110101010100000', '01010110101010000', '10100101101010101', '00100101101100000', '01010010101110000', '00101010011100100', '01101000101100000',#2080
                 '01110100101101000', '01101010100100000', '01101101010100000', '10110101010100110', '00101011011010000', '00100101011100000', '01010100111010100', '01010001011010000', '01101000101010000', '01111001001010010',#2090
                 '01101010100100000']#2100
#lmonth_day=(0)#0是29天，1是30天
#month_day=(1,14)#第一个数是闰月的天数，之后12个是1到12月的天数
#lmonth=(14,18)#最后4个数字是闰月的月份的2进制
newyear=['19000131', '19010219', '19020208', '19030129', '19040216', '19050204', '19060125', '19070213', '19080202', '19090122',
         '19100210', '19110130', '19120218', '19130206', '19140126', '19150214', '19160203', '19170123', '19180211', '19190201',
         '19200220', '19210208', '19220128', '19230216', '19240205', '19250124', '19260213', '19270202', '19280123', '19290210',
         '19300130', '19310217', '19320206', '19330126', '19340214', '19350204', '19360124', '19370211', '19380131', '19390219',
         '19400208', '19410127', '19420215', '19430205', '19440125', '19450213', '19460202', '19470122', '19480210', '19490129',
         '19500217', '19510206', '19520127', '19530214', '19540203', '19550124', '19560212', '19570131', '19580218', '19590208',
         '19600128', '19610215', '19620205', '19630125', '19640213', '19650202', '19660121', '19670209', '19680130', '19690217',
         '19700206', '19710127', '19720215', '19730203', '19740123', '19750211', '19760131', '19770218', '19780207', '19790128',
         '19800216', '19810205', '19820125', '19830213', '19840202', '19850220', '19860209', '19870129', '19880217', '19890206',
         '19900127', '19910215', '19920204', '19930123', '19940210', '19950131', '19960219', '19970207', '19980128', '19990216',
         '20000205', '20010124', '20020212', '20030201', '20040122', '20050209', '20060129', '20070218', '20080207', '20090126',
         '20100214', '20110203', '20120123', '20130210', '20140131', '20150219', '20160208', '20170128', '20180216', '20190205',
         '20200125', '20210212', '20220201', '20230122', '20240210', '20250129', '20260217', '20270206', '20280126', '20290213',
         '20300203', '20310123', '20320211', '20330131', '20340219', '20350208', '20360128', '20370215', '20380204', '20390124',
         '20400212', '20410201', '20420122', '20430210', '20440130', '20450217', '20460206', '20470126', '20480214', '20490202',
         '20500123', '20510211', '20520201', '20530219', '20540208', '20550128', '20560215', '20570204', '20580124', '20590212',
         '20600202', '20610121', '20620209', '20630129', '20640217', '20650205', '20660126', '20670214', '20680203', '20690123',
         '20700211', '20710131', '20720219', '20730207', '20740127', '20750215', '20760205', '20770124', '20780212', '20790202',
         '20800122', '20810209', '20820129', '20830217', '20840206', '20850126', '20860214', '20870203', '20880124', '20890210',
         '20900130', '20910218', '20920207', '20930127', '20940215', '20950205', '20960125', '20970212', '20980201', '20990121',
         '21000209']
btoh={"0001":1,"0010":2,"0011":3,"0100":4,"0101":5,"0110":6,"0111":7,"1000":8,"1001":9,"1010":10,"1011":11,"1100":12}
lmname={1:"正月",2:"二月",3:"三月",4:"四月",5:"五月",6:"六月",7:"七月",8:"八月",9:"九月",10:"十月",11:"冬月",12:"腊月"}
ldname={1:"初一",2:"初二",3:"初三",4:"初四",5:"初五",6:"初六",7:"初七",8:"初八",9:"初九",10:"初十",
        11:"十一",12:"十二",13:"十三",14:"十四",15:"十五",16:"十六",17:"十七",18:"十八",19:"十九",20:"二十",
        21:"廿一",22:"廿二",23:"廿三",24:"廿四",25:"廿五",26:"廿六",27:"廿七",28:"廿八",29:"廿九",30:"三十"}
class Lu():
    def __init__(self,year,month,day):
        self.year=year
        self.month=month
        self.day=day
        self.yd=lyear_month_day[self.year-1900]

    def s_to_l(self):
        for y in newyear:
            if int(y[0:4])==self.year:
                year=int(y[0:4])
                month=int(y[4:6])
                day=int(y[6:])
                self.yd=lyear_month_day[lyear_month_day.index(self.yd)-1]
                if month==self.month:
                    if day>self.day:
                        y=newyear[newyear.index(y)-1]
                        year=int(y[0:4])
                        month=int(y[4:6])
                        day=int(y[6:])
                        self.yd=lyear_month_day[lyear_month_day.index(self.yd)-1]
                elif month>self.month:
                    y=newyear[newyear.index(y)-1]
                    year=int(y[0:4])
                    month=int(y[4:6])
                    day=int(y[6:])
                    self.yd=lyear_month_day[lyear_month_day.index(self.yd)-1]
                break
        self.days=m2.m2(year,month,day,self.year,self.month,self.day)
        self.leap_month()
        left_days=self.days
        while left_days>0:
            if self.lmonth==self.leapmonth and self.ism==False:
                self.isleapmonth=True
                self.lmonth-=1
                self.ism=True
            left_days=left_days-self.lday
            if left_days>0:
                self.lmonth+=1
                if self.isleapmonth==False:
                    self.lday=int(self.yd[self.lmonth])+29
                else:
                    self.lday=self.leapmonth_day
                    self.isleapmonth=False
        while left_days!=0:
            self.lday-=1
            left_days+=1
        if self.isleapmonth and self.ism:
            self.lmonth+=1
        self.lday+=1
        if self.lday>int(self.yd[self.lmonth])+29:
            if self.lmonth!=1:
                self.lmonth+=1
            self.lday=1
        lmonth=lmname[self.lmonth]
        lday=ldname[self.lday]
        if (not self.isleapmonth) and self.ism:
            lmonth="闰"+lmonth
        return lmonth,lday

    def l_to_s(self):
        self.leap_month()
        self.days=0
        while self.lmonth!=self.month:
            if self.lmonth==self.leapmonth and self.ism==False:
                self.isleapmonth=True
                self.lmonth-=1
                self.ism=True
            self.days+=self.lday
            self.lmonth+=1
            if self.isleapmonth==False:
                self.lday=int(self.yd[self.lmonth])+29
            else:
                self.lday=self.leapmonth_day
                self.isleapmonth=False
        self.lday=0
        while self.lday!=self.day:
            self.days+=1
            self.lday+=1
        self.days-=1
        for y in newyear:
            if int(y[0:4])==self.year:
                year=int(y[0:4])
                month=int(y[4:6])
                day=int(y[6:])
                break
        return m1.m1(year,month,day,self.days)

    def is_lyear(self):
        islyear=False
        if self.year%100!=0:
            if self.year%4==0:
                islyear=True
            else:
                islyear=False
        elif self.year%400==0:
            islyear=True
        else:
            islyear=False
        return islyear
    
    def leap_month(self):
        if self.yd[13:]!="0000":
            self.leapmonth=btoh[self.yd[13:]]
            self.leapmonth_day=int(self.yd[0])+29
        else:
            self.leapmonth=0
        self.lmonth=1
        self.lday=int(self.yd[self.lmonth])+29
        self.isleapmonth=False
        self.ism=False

def months(lyear):
    yd=lyear_month_day[lyear-1900]
    ms=["正月","二月","三月","四月","五月","六月","七月","八月","九月","十月","冬月","腊月"]
    if yd[13:]!="0000":
        ms.insert(ms.index(lmname[btoh[yd[13:]]])+1,"闰"+lmname[btoh[yd[13:]]])
    return ms

def days(lyear,lmonth):
    yd=lyear_month_day[lyear-1900]
    ms=["正月","二月","三月","四月","五月","六月","七月","八月","九月","十月","冬月","腊月"]
    if "闰" in lmonth:
        ds=int(yd[0])+29
    else:
        ds=int(yd[ms.index(lmonth)+1])+29
    return list(ldname.values())[:ds]

def yy(y):
    tg={4:"甲",5:"乙",6:"丙",7:"丁",8:"戊",9:"己",0:"庚",1:"辛",2:"壬",3:"葵"}
    dz={4:"子",5:"丑",6:"寅",7:"卯",8:"辰",9:"巳",10:"午",11:"未",0:"申",1:"酉",2:"戌",3:"亥"}
    if type(y)==int:
        y=str(y)
    n=["",""]
    n[0]=tg[int(y[-1])]
    n[0]=n[0]+dz[int(y)%12]
    sx={"子":"鼠","丑":"牛","寅":"虎","卯":"兔","辰":"龙","巳":"蛇","午":"马","未":"羊","申":"猴","酉":"鸡","戌":"狗","亥":"猪"}
    n[1]=sx[n[0][-1]]
    return n